---
# Traefik Helm Chart Values
# https://github.com/traefik/traefik-helm-chart/blob/master/traefik/values.yaml

# Deployment configuration
deployment:
  enabled: true
  replicas: 1
  podAnnotations: {}
  podLabels: {}

# Service configuration
service:
  enabled: true
  type: LoadBalancer
  # Uncomment and set if you want a specific LoadBalancer IP
  loadBalancerIP: "10.0.2.102"

# Ports configuration
ports:
  web:
    port: 80
    exposedPort: 80
    protocol: TCP
  websecure:
    port: 443
    exposedPort: 443
    protocol: TCP
    # Enable TLS
    tls:
      enabled: true
  # Dashboard port
  traefik:
    port: 9000
    exposedPort: 9000
    protocol: TCP

# Ingress routes
ingressRoute:
  dashboard:
    enabled: true
    # Expose dashboard via HTTPS
    entryPoints: ["websecure"]
    matchRule: Host(`traefik.hl.rushbtech.org`)
    tls:
      certResolver: letsencrypt

# Enable dashboard
ingressClass:
  enabled: true
  isDefaultClass: true

# Logs
logs:
  general:
    level: INFO
  access:
    enabled: true

# Metrics (optional - enable for Prometheus)
metrics:
  prometheus:
    enabled: false
    # entryPoint: metrics
    # addEntryPointsLabels: true
    # addServicesLabels: true

# Resources
resources:
  requests:
    cpu: "100m"
    memory: "128Mi"
  limits:
    cpu: "500m"
    memory: "512Mi"

# Persistence for SSL certificates (required for Let's Encrypt)
persistence:
  enabled: true
  name: traefik-certs
  accessMode: ReadWriteOnce
  size: 128Mi
  path: /data

# Additional arguments for Traefik
additionalArguments:
  - "--providers.kubernetescrd"
  - "--providers.kubernetesingress"
  # Uncomment for Let's Encrypt
  - "--certificatesresolvers.letsencrypt.acme.email=dkerr@rushbtech.org"
  - "--certificatesresolvers.letsencrypt.acme.storage=/data/acme.json"
  - "--certificatesresolvers.letsencrypt.acme.httpchallenge.entrypoint=web"

# Environment variables
env: []

# Security context
securityContext:
  capabilities:
    drop: [ALL]
  readOnlyRootFilesystem: true
  runAsGroup: 65532
  runAsNonRoot: true
  runAsUser: 65532

# Pod security context
podSecurityContext:
  fsGroup: 65532
